const CropImageByBorder={get4Points_:function(o,r,borderColor){const colors=r.map(({c:c})=>c),left=colors.indexOf(borderColor),right=colors.lastIndexOf(borderColor);return!(!Object.values(o).every(e=>0==e)||-1==left||-1==right)&&(o.lx=r[left].x,o.ly=r[left].y,o.rx=r[right].x,o.ry=r[right].y,!0)},getCoordinates_:function(ctx,width,height,borderColor){const self=this,ar=[];for(var y=0;y<height;y++){const temp=[];for(var x=0;x<width;x++){const{data:data}=ctx.getImageData(x,y,1,1),[r,g,b]=data,cc=(r<<16|g<<8|b).toString(16),c="#"+(isNaN(cc)?cc:String(cc).padStart(6,"0"));temp.push({x:x,y:y,c:c})}ar.push(temp)}const[top,end]=[...Array(2)].map(_=>{const o={lx:0,ly:0,rx:0,ry:0};for(let i=0;i<ar.length&&!self.get4Points_(o,ar[i],borderColor);i++);return ar.reverse(),o});if(console.log({top:top,end:end}),[top,end].every(e=>Object.values(e).every(f=>0==f)))throw new Error("There is no border for cropping image. Please confirm the border, again");return{top:top,end:end}},getInnerImage:function({base64Data:base64Data,borderColor:borderColor}){return new Promise((resolve,reject)=>{try{const self=this,offset=1,cvs=document.createElement("canvas"),ctx=cvs.getContext("2d"),img=new Image;img.src=base64Data,img.onload=function(){const width=img.naturalWidth,height=img.naturalHeight;cvs.width=width,cvs.height=height,ctx.drawImage(img,0,0);const{top:top,end:end}=self.getCoordinates_(ctx,width,height,borderColor),newWidth=top.rx-top.lx-offset,newHeight=end.ly-top.ly-offset;cvs.width=newWidth,cvs.height=newHeight,ctx.clearRect(0,0,newWidth,newHeight),ctx.drawImage(img,top.lx+offset,top.ly+offset,newWidth,newHeight,0,0,newWidth,newHeight);const base64=cvs.toDataURL("image/png");resolve(base64)}}catch(e){reject(e)}})}};